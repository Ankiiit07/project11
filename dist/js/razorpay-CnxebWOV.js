var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(r,t,o)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o,c=(e,r)=>{for(var t in r||(r={}))n.call(r,t)&&i(e,t,r[t]);if(o)for(var t of o(r))a.call(r,t)&&i(e,t,r[t]);return e},s=(e,r,t)=>new Promise((o,n)=>{var a=e=>{try{c(t.next(e))}catch(r){n(r)}},i=e=>{try{c(t.throw(e))}catch(r){n(r)}},c=e=>e.done?o(e.value):Promise.resolve(e.value).then(a,i);c((t=t.apply(e,r)).next())});class d{constructor(){this.isScriptLoaded=!1,this.scriptLoadPromise=null}static getInstance(){return d.instance||(d.instance=new d),d.instance}loadRazorpayScript(){return s(this,null,function*(){return!!this.isScriptLoaded||(window.Razorpay?(this.isScriptLoaded=!0,!0):(this.scriptLoadPromise||(this.scriptLoadPromise=new Promise(e=>{const r=document.createElement("script");r.src="https://checkout.razorpay.com/v1/checkout.js",r.async=!0,r.onload=()=>{this.isScriptLoaded=!0,e(!0)},r.onerror=r=>{this.isScriptLoaded=!1,e(!1)};const t=setTimeout(()=>{this.isScriptLoaded=!1,e(!1)},1e4);r.onload=()=>{clearTimeout(t),this.isScriptLoaded=!0,e(!0)},document.head.appendChild(r)})),this.scriptLoadPromise))})}createOrder(e,r="INR",t){return s(this,null,function*(){if("number"!=typeof e||isNaN(e)||e<1)throw new Error("Invalid amount provided");return this.createMockOrder(e,r,t)})}createMockOrder(e,r="INR",t){const o=Date.now();return{id:`order_${o}_${Math.random().toString(36).substring(2,15)}`,entity:"order",amount:Math.round(100*e),amount_paid:0,amount_due:Math.round(100*e),currency:r,receipt:t||`receipt_${o}`,status:"created",created_at:o,notes:{source:"mock-order-for-development"}}}verifyPayment(e,r,t){return s(this,null,function*(){return!!(e&&r&&t)&&(e.startsWith("order_"),!0)})}initiatePayment(e){return s(this,null,function*(){try{if(!(yield this.loadRazorpayScript())||!window.Razorpay)throw new Error("Razorpay SDK not loaded. Please check your internet connection and try again.");if(!e.amount||e.amount<=0)throw new Error("Invalid payment amount");if(!e.name||!e.description)throw new Error("Payment name and description are required");e.order_id;const a=(o=c({key:"rzp_test_Glauu4hA3vRcyV"},e),n={callback_url:"https://eneqd3r9zrjok.x.pipedream.net/",theme:c({color:"#8B7355"},e.theme),modal:c({ondismiss:()=>{var r,t;null==(t=null==(r=e.modal)?void 0:r.ondismiss)||t.call(r)},confirm_close:!0,escape:!0,animation:!0},e.modal),retry:c({enabled:!0,max_count:3},e.retry),timeout:300,remember_customer:!1},r(o,t(n))),i=new window.Razorpay(a);i.on("payment.failed",e=>{throw alert(`Payment failed: ${e.error.description||"Unknown error occurred"}`),new Error(`Payment failed: ${e.error.description||"Unknown error"}`)}),i.on("payment.cancelled",()=>{throw alert("Payment was cancelled by user"),new Error("Payment was cancelled by user")}),i.open()}catch(a){throw a instanceof Error?a:new Error("Failed to open Razorpay payment modal")}var o,n})}static formatAmount(e){return`â‚¹${e.toFixed(2)}`}static toPaise(e){return Math.round(100*e)}static toRupees(e){return e/100}}const l=d.getInstance();export{l as r};
